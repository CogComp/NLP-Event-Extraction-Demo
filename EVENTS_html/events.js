var xel_examples = {
    "eng": [
		// "In the January attack, two Palestinian suicide bombers blew themselves up in central Tel Aviv. The bombing destroyed the whole building, killing 23 other people. Police fatally shot a suspect of the bombing who ended up killing himself this morning.",
		// "In the January attack, two Palestinian suicide bombers blew themselves up in central Tel Aviv. The bombing destroyed the whole building, killing 23 other people.",
		// "In the January attack, two Palestinian suicide bombers blew themselves up in central Tel Aviv, killing 23 other people.",
		// "Despite operating under bankruptcy laws, united posted the best on time performance.",
		// "The bombing destroys the whole building.",
//		"Sigmund Freud was an Austrian neurologist and the founder of psychoanalysis, a clinical method for treating psychopathology through dialogue between a patient and a psychoanalyst. Freud was born to Galician Jewish parents in the Moravian town of Freiberg, in the Austrian Empire. He qualified as a doctor of medicine in 1881 at the University of Vienna. Freud lived and worked in Vienna, having set up his clinical practice there in 1886. In 1938, Freud left Austria to escape Nazi persecution. He died in exile in the United Kingdom in 1939.",
//        "Barack Hussein Obama II is an American politician and attorney who served as the 44th president of the United States from 2009 to 2017. A member of the Democratic Party, Obama was the first African-American president of the United States. He previously served as a U.S. senator from Illinois from 2005 to 2008 and an Illinois state senator from 1997 to 2004.",
//		"Mohandas Karamchand Gandhi was an Indian lawyer, anti-colonial nationalist, and political ethicist. He employed nonviolent resistance to lead the successful campaign for India's independence from British rule, and in turn inspired movements for civil rights and freedom across the world. The honorific Mah훮tm훮, first applied to him in 1914 in South Africa, is now used throughout the world.",
//		"More about Freud... \n\nSigmund Freud was an Austrian neurologist and the founder of psychoanalysis, a clinical method for treating psychopathology through dialogue between a patient and a psychoanalyst. Freud was born to Galician Jewish parents in the Moravian town of Freiberg, in the Austrian Empire. He qualified as a doctor of medicine in 1881 at the University of Vienna. Freud lived and worked in Vienna, having set up his clinical practice there in 1886. In 1938, Freud left Austria to escape Nazi persecution. He died in exile in the United Kingdom in 1939. \n\nIn founding psychoanalysis, Freud developed therapeutic techniques such as the use of free association and discovered transference, establishing its central role in the analytic process. Freud's redefinition of sexuality to include its infantile forms led him to formulate the Oedipus complex as the central tenet of psychoanalytical theory. His analysis of dreams as wish-fulfillments provided him with models for the clinical analysis of symptom formation and the underlying mechanisms of repression. On this basis Freud elaborated his theory of the unconscious and went on to develop a model of psychic structure comprising id, ego and super-ego. Freud postulated the existence of libido, a sexualised energy with which mental processes and structures are invested and which generates erotic attachments, and a death drive, the source of compulsive repetition, hate, aggression and neurotic guilt. In his later works, Freud developed a wide-ranging interpretation and critique of religion and culture. \n\nThough in overall decline as a diagnostic and clinical practice, psychoanalysis remains influential within psychology, psychiatry, and psychotherapy, and across the humanities. It thus continues to generate extensive and highly contested debate with regard to its therapeutic efficacy, its scientific status, and whether it advances or hinders the feminist cause.Nonetheless, Freud's work has suffused contemporary Western thought and popular culture. W. H. Auden's 1940 poetic tribute to Freud describes him as having created \"a whole climate of opinion / under whom we conduct our different lives.\"",
//		"More about Gandhi... \n\nMohandas Karamchand Gandhi was an Indian lawyer, anti-colonial nationalist, and political ethicist. He employed nonviolent resistance to lead the successful campaign for India's independence from British rule, and in turn inspired movements for civil rights and freedom across the world. The honorific Mah훮tm훮, first applied to him in 1914 in South Africa, is now used throughout the world. \n\nBorn and raised in a Hindu family in coastal Gujarat, western India, Gandhi trained in law at the Inner Temple, London, and was called to the bar at age 22 in June 1891. After two uncertain years in India, where he was unable to start a successful law practice, he moved to South Africa in 1893 to represent an Indian merchant in a lawsuit. He went on to stay for 21 years. It was in South Africa that Gandhi raised a family, and first employed nonviolent resistance in a campaign for civil rights. In 1915, aged 45, he returned to India. He set about organising peasants, farmers, and urban labourers to protest against excessive land-tax and discrimination. Assuming leadership of the Indian National Congress in 1921, Gandhi led nationwide campaigns for easing poverty, expanding women's rights, building religious and ethnic amity, ending untouchability, and above all for achieving Swaraj or self-rule. \n\nThe same year Gandhi adopted the Indian loincloth, or short dhoti and, in the winter, a shawl, both woven with yarn hand-spun on a traditional Indian spinning wheel, or charkha, as a mark of identification with India's rural poor. Thereafter, he lived modestly in a self-sufficient residential community, ate simple vegetarian food, and undertook long fasts as a means of self-purification and political protest. Bringing anti-colonial nationalism to the common Indians, Gandhi led them in challenging the British-imposed salt tax with the 400 km (250 mi) Dandi Salt March in 1930, and later in calling for the British to Quit India in 1942. He was imprisoned for many years, upon many occasions, in both South Africa and India."
		"The devastated family of a Brooklyn fifth-grader who died suddenly last week in the wake of several incidents of what relatives described as school bullying demanded answers Friday from education and health officials on how the tragedy unfolded.",
		"A short drive away, Ismokoweni, who leads 'Aisyiyah's local environmental chapter and goes by one name, picks her way past painted gravestones towards an area of damaged forest where the group has also planted seedlings.",
		"Media reports on suicides should also be cautious, because a large number of foreign studies have suggested that inappropriate media coverage can encourage imitation.",
		"Two states - Karnataka, which includes tech hub Bengaluru, and Maharashtra, which includes Mumbai - have announced they will temporarily suspend vaccination for people aged 18-44 years as they prioritize those over 45 who need their second dose.",
		"Pope Urban II encouraged military support for Byzantine Emperor Alexios I against the Seljuk Turks and an armed pilgrimage to Jerusalem. Volunteers took a public vow to join the crusade. Historians now debate the combination of their motivations, which included the prospect of mass ascension into Heaven at Jerusalem, satisfying feudal obligations, opportunities for renown, and economic and political advantage.",
		"A firefighter and his crew battled to keep the raging Glass Fire from devastating an upmarket Napa Valley vineyard. The firefiighter denies lighting backfires which consume fuel in a wildfire's path but admits his team failed to advise Cal Fire, the state's fire agency that it was in the evacuated area, as required by law.",
		"The incident highlights how a booming business in private firefighting is creating friction with government firefighters as wildfires grow more frequent and dangerous across the western US. It also underscores the inequity of who receives protection. Businesses and wealthy property owners have growing options to protect themselves, for a price. Meanwhile, homeowners across California are being denied homeowner's insurance renewals because of wildfire risk.",
		"The bombers blew themselves up among a crowd of shoppers at a second-hand clothes market in Tayaran Square. The last deadly suicide attack in the city was in January 2018, when 35 people were killed in the same square. No group has said it carried out the latest attack, but suspicion will fall on the jihadist group Islamic State. The Iraqi government declared victory in its war against IS at the end of 2017. However, sleeper cells continue to wage a low-level insurgency in the country, operating mainly in rural areas and targeting security forces.",
		"According to the US justice department, at about noon that day several of the contractors opened fire in and around Nisoor Square, a busy roundabout that was immediately adjacent to the heavily-fortified Green Zone.",
		"US prosecutors said Slatten was the first to fire, without provocation, killing Ahmed Haithem Ahmed Al Rubiay, an aspiring doctor who was driving his mother to an appointment. The contractors said they mistakenly believed that they were under attack. The incident caused international outrage, strained relations between the US and Iraq, and sparked a debate over the role of contractors in warzones.",
		"Several witnesses insisted that the contractors had panicked and opened fire indiscriminately.",
		"In 2014, a US federal court found Slatten guilty of murder, while Slough, Liberty and Heard were convicted of voluntary manslaughter, attempted manslaughter and other charges. Slatten was sentenced to life in prison, and the other three were handed 30-year terms.",
		"Boris Johnson has condemned the \"shameful racism\" aimed at British Jews, after a video appeared to show people shouting anti-Semitic abuse. It comes amid rising tension between Israel and Palestinians in the Middle East, culminating in the worst violence since 2014.",
		"Within weeks, China had managed to test 9 million people for SARS-CoV-2 in Wuhan. It set up an effective national system of contact tracing.Across the country, 14000 health checkpoints were established at public transport hubs. By contrast, the UK's capacity for contact tracing was overwhelmed soon after the pandemic struck the country.",
		"My research suggests that the control of the virus in China is not the result of authoritarian policy, but of a national prioritization of health. China learned a tough lesson with SARS, the first coronavirus pandemic of the 21st century.",
		"The latest conflict continues to rapidly escalate between Israel and Hamas. Both sides are sticking to their own argument over how the conflict started.",
		"A suspected suicide bomb attack outside a Catholic church has left at least 14 people wounded. A destroyed motorbike and body parts were found at the scene and police said the two attackers had died. Militant Islamists have attacked churches in the past but no group has yet said it was behind the bombing.",
		"There were two people riding on a motorbike when the explosion happened at the main gate of the church. Footage from security cameras showed fire, smoke and debris being blown into the middle of the road.",
		"The goverment has banned public schools from making religious attire compulsory, after the story of a Christian student being pressured to wear a headscarf in class went viral. The 16-year-old girl was attending a school that had a rule that all students had to wear the Muslim headscarf. The government has given schools 30 days to revoke any existing rules. But there are growing concerns about rising religious intolerance. The ban was signed into decree on Wednesday, and schools which do not comply may face sanctions.",
		"We all know what a Mad Hatter's tea party looks like, can liken hapless pairs to Tweedledum and Tweedledee, or a big grin to a Cheshire cat. The image of a little blonde girl in a blue dress and an Alice band is always and inevitably, well, Alice. (Yes, the headband is named after her).",
		"A tuk-tuk driver wants to do his bit to help his fellow citizens weather the pandemic. So, he has turned his humble vehicle into an ambulance, ferrying people to and from hospitals for free. This is a huge help given the shortage of ambulances as the city struggles against a deadly second wave of Covid-19. Cases have risen rapidly in the past month, leading to an acute shortage of hospital beds, medicines and oxygen. The crisis has also contributed to a sharp increase in Covid deaths."
	]
}

function fillExampleSelectField() {
	hideResult();
	lang="eng";
	// alert("examples...");
	$("#example").empty();
	selectField = document.getElementById("example");
	textField = document.getElementById("text");
	idx = 0;
	for (var example in xel_examples[lang]) {
		var opt = document.createElement("option");
		opt.value=idx;
		opt.innerHTML = xel_examples[lang][idx].substring(0,50)+"..."; 
		selectField.appendChild(opt);
		idx += 1;
	}	
	selectField.value = "0";
	textField.value = xel_examples[lang][0];
}

function newExampleSelect() {
	hideResult();
	// langSelectField = document.getElementById("lang");
	lang = "eng"; // langSelectField.value;
	exampleSelectField = document.getElementById("example");
	example = exampleSelectField.value;
	textField = document.getElementById("text");
	// textField.value = xel_langs[languageSelected]["text"]; 
	textField.value = xel_examples[lang][example]; 
}

function getSelectedAnnotators() {
	var selectedAnnotators = [];
	var annotator_buttons = document.getElementsByClassName('annotator');
	for(var i = 0; i<annotator_buttons.length;i++)
	{
		var ann_button = annotator_buttons[i];
		//console.log(checkbox_button);
		if(ann_button.checked) {
			//alert(ann_button.id);
			var text_of_button = ann_button.id;
			//console.log(text_of_button);
			selectedAnnotators.push(text_of_button);
		}
	}
	return selectedAnnotators;
}

function hideResult() {
	$("#result").hide();
	$("#result").html("");
}

function showResult() {
	$("#result").show();
}

/*
async function httpPOST(url = '', data = {}, pfunction) {
  console.log(url);
  console.log(JSON.stringify(data));
  fetch(url, {
    method: 'POST',
    mode: 'no-cors',
	cache: 'no-cache',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  }).then(resp => resp.json())
        .then(json => {
                pfunction(json);
        });
}
*/

async function postInput(url = '', data = {}) {
	const response = await fetch(url, {
    method: 'POST', // *GET, POST, PUT, DELETE, etc.
    //mode: 'no-cors', // no-cors, *cors, same-origin
    // cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
    // credentials: 'omit', // include, *same-origin, omit
    headers: {
        'Content-Type': 'application/json',
       // 'Accept': 'application/json, text/plaini, */*'
      //'Content-Type': 'application/json'
        //,'Data-Type': 'application/json'
      // 'Content-Type': 'application/x-www-form-urlencoded',
    },
    // redirect: 'follow', // manual, *follow, error
    // referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
    body: JSON.stringify(data) // body data type must match "Content-Type" header
    //body: data
  });
  return response.json(); // parses JSON response into native JavaScript objects
}

function formSubmit() {
	hideResult();
	$("#result").html("Working...");
	showResult();
	anns = getSelectedAnnotators();
	text = document.getElementById("text").value;
	data = {
		"text": text,
		"anns": anns
	};
	url = "view";
	postInput(url, data)
		.then(data => {
			// console.log(data);
			$("#result").html(data.html);
			showResult();
    });
	// $("#result").html(anns.join(","));
	// showResult();
	return false;
}

function main() {
	fillExampleSelectField();
}


